import streamlit as st
import pandas as pd
import matplotlib.pyplot as plt

st.title("Blutzucker-Tracker ")

# Blutzucker-Tracker
blutzuckerwert = st.number_input("Gib deinen Blutzuckerwert ein", min_value=0)
zeitpunkt = st.selectbox("Zeitpunkt", ["Nüchtern", "Nach dem Essen"])

if 'daten' not in st.session_state:
    st.session_state['daten'] = []

if st.button("Eintrag hinzufügen"):
    st.session_state['daten'].append({"blutzuckerwert": blutzuckerwert, "zeitpunkt": zeitpunkt})
    st.success("Eintrag erfolgreich hinzugefügt")
    
    # Tipps basierend auf dem Blutzuckerwert
    if blutzuckerwert < 70:
        st.warning("Dein Blutzuckerwert ist niedrig. Es wird empfohlen, schnell wirkende Kohlenhydrate wie Saft oder Traubenzucker zu dir zu nehmen.")
    elif blutzuckerwert > 180:
        st.warning("Dein Blutzuckerwert ist erhöht. Es wird empfohlen, deinen Blutzucker regelmäßig zu überwachen und gegebenenfalls Insulin zu verabreichen.")
    
if st.session_state['daten']:
    df = pd.DataFrame(st.session_state['daten'])
    st.write(df)
    
    fig, ax = plt.subplots()
    for label, df_group in df.groupby("zeitpunkt"):
        df_group.plot(x="zeitpunkt", y="blutzuckerwert", ax=ax, label=label, marker='o')
    st.pyplot(fig)

